(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{h9W5:function(e,t,r){"use strict";r.r(t),r.d(t,"OrdersModule",(function(){return x}));var c=r("ofXK"),i=r("PCNd"),s=r("tyNb"),o=r("kt0X");const n=e=>e.orders,a=Object(o.p)(n,e=>e.ordersListing),b=Object(o.p)(n,e=>e.loading);var d=r("3E0/"),l=r("P7K9"),u=r("bbeA"),p=r("fXoL"),h=r("668k"),f=r("dbUT"),y=r("sYmb"),v=r("9lMO");function g(e,t){if(1&e){const e=p.Yb();p.Xb(0,"tr",7),p.fc("click",(function(){p.Bc(e);const r=t.$implicit;return p.hc(2).navigate(r)})),p.Xb(1,"th",8),p.Kc(2),p.Wb(),p.Xb(3,"td"),p.Kc(4),p.Wb(),p.Xb(5,"td"),p.Kc(6),p.Wb(),p.Xb(7,"td"),p.Kc(8),p.Wb(),p.Xb(9,"td"),p.Kc(10),p.ic(11,"async"),p.ic(12,"enum"),p.Wb(),p.Xb(13,"td"),p.Kc(14),p.Wb(),p.Wb()}if(2&e){const e=t.$implicit,r=t.index,c=p.hc(2);p.Cb(2),p.Lc(r),p.Cb(2),p.Lc(e.title),p.Cb(2),p.Lc(e.description),p.Cb(2),p.Lc(e.price),p.Cb(2),p.Lc(p.jc(11,6,p.kc(12,8,e.status,"OrderStatus"))),p.Cb(4),p.Lc(c.isSeller?e.buyer.displayName:e.seller.displayName)}}function m(e,t){if(1&e&&(p.Xb(0,"table",4),p.Xb(1,"thead"),p.Xb(2,"tr"),p.Xb(3,"th"),p.Kc(4,"#"),p.Wb(),p.Xb(5,"th",5),p.Kc(6,"order.fields.title"),p.Wb(),p.Xb(7,"th",5),p.Kc(8,"order.fields.description"),p.Wb(),p.Xb(9,"th",5),p.Kc(10,"order.fields.price"),p.Wb(),p.Xb(11,"th",5),p.Kc(12,"order.fields.status"),p.Wb(),p.Xb(13,"th"),p.Kc(14),p.ic(15,"translate"),p.Wb(),p.Wb(),p.Wb(),p.Xb(16,"tbody"),p.Ic(17,g,15,11,"tr",6),p.ic(18,"async"),p.Wb(),p.Wb()),2&e){const e=p.hc();p.Cb(14),p.Lc(p.jc(15,2,e.isSeller?"order.virtualFields.buyerName":"order.virtualFields.sellerName")),p.Cb(3),p.nc("ngForOf",p.jc(18,4,e.orders$))}}let O=(()=>{class e{constructor(e,t,r){this.store=e,this.activeRoute=t,this.router=r,this.subscriptions=[]}ngOnInit(){this.subscriptions.push(this.activeRoute.url.subscribe(e=>{this.isSeller=e[0]&&"seller"===e[0].path,this.store.dispatch(new l.a({type:this.isSeller?u.b.SELLER:u.b.BUYER,userId:e[1]?e[1].path:void 0}))})),this.isLoading$=this.store.select(b).pipe(Object(d.a)(0)),this.orders$=this.store.pipe(Object(o.q)(a))}ngOnDestroy(){this.subscriptions.forEach(e=>{e.unsubscribe()})}navigate(e){this.router.navigate([`${this.isSeller?"seller":"buyer"}/orderDetail/${e.uid}`],{relativeTo:this.activeRoute.parent})}}return e.\u0275fac=function(t){return new(t||e)(p.Rb(o.h),p.Rb(s.a),p.Rb(s.c))},e.\u0275cmp=p.Lb({type:e,selectors:[["app-orders"]],decls:10,vars:12,consts:[[1,"px-4","white","section-header"],[1,"container-fluid"],["mdbTable","","hover","true",4,"ngIf"],[3,"isLoading","showNoRecordsMessage"],["mdbTable","","hover","true"],["translate",""],["mdbTableRow","",3,"click",4,"ngFor","ngForOf"],["mdbTableRow","",3,"click"],["scope","row"]],template:function(e,t){if(1&e&&(p.Xb(0,"div",0),p.Xb(1,"h3"),p.Kc(2),p.ic(3,"translate"),p.Wb(),p.Wb(),p.Xb(4,"div",1),p.Ic(5,m,19,6,"table",2),p.ic(6,"async"),p.Sb(7,"app-loader",3),p.ic(8,"async"),p.ic(9,"async"),p.Wb()),2&e){var r;const e=!(null!=(r=p.jc(9,10,t.orders$))&&r.length);p.Cb(2),p.Lc(p.jc(3,4,t.isSeller?"header.sellerToolsDropdown.soldOrders":"header.sellerToolsDropdown.boughtOrders")),p.Cb(3),p.nc("ngIf",!p.jc(6,6,t.isLoading$)),p.Cb(2),p.nc("isLoading",p.jc(8,8,t.isLoading$))("showNoRecordsMessage",e)}},directives:[c.t,h.a,f.Q,y.a,c.s,f.R],pipes:[y.d,c.b,v.a],styles:[""]}),e})();var X=r("1C/U"),j=r("NnDD"),W=r("Z21x"),w=r("+a7H");function S(e,t){if(1&e&&p.Sb(0,"app-user-profile-preview",7),2&e){const e=p.hc(2);p.nc("userProfile",e.order.seller)}}function R(e,t){if(1&e&&p.Sb(0,"app-user-profile-preview",7),2&e){const e=p.hc(2);p.nc("userProfile",e.order.buyer)}}function L(e,t){if(1&e&&(p.Xb(0,"mdb-card"),p.Xb(1,"mdb-card-header"),p.Kc(2),p.Wb(),p.Xb(3,"div",1),p.Ic(4,S,1,1,"app-user-profile-preview",2),p.Ic(5,R,1,1,"app-user-profile-preview",2),p.Wb(),p.Xb(6,"mdb-card-body"),p.Xb(7,"mdb-card-text"),p.Kc(8),p.Wb(),p.Wb(),p.Xb(9,"ul",3),p.Xb(10,"li",4),p.Kc(11),p.ic(12,"translate"),p.Wb(),p.Xb(13,"li",4),p.Xb(14,"span"),p.Kc(15),p.ic(16,"translate"),p.Wb(),p.Xb(17,"mdb-badge",5),p.Kc(18),p.ic(19,"async"),p.ic(20,"enum"),p.Wb(),p.Wb(),p.Wb(),p.Xb(21,"mdb-card-body"),p.Sb(22,"app-back-button"),p.Xb(23,"button",6),p.Kc(24,"Fake Action 1"),p.Wb(),p.Xb(25,"button",6),p.Kc(26,"Fake Action 2"),p.Wb(),p.Wb(),p.Wb()),2&e){const e=p.hc();p.Cb(2),p.Lc(e.order.title),p.Cb(2),p.nc("ngIf",!e.hideSeller),p.Cb(1),p.nc("ngIf",!e.hideBuyer),p.Cb(3),p.Mc(" ",e.order.description," "),p.Cb(3),p.Nc(" ",p.jc(12,8,"order.fields.price"),": ",e.order.price," "),p.Cb(4),p.Mc(" ",p.jc(16,10,"order.fields.status"),": "),p.Cb(3),p.Mc(" ",p.jc(19,12,p.kc(20,14,e.order.status,"OrderStatus"))," ")}}let I=(()=>{class e{constructor(e,t){this.activeRoute=e,this.ordersService=t,this.hideSeller=!1,this.hideBuyer=!1,this.subscriptions=[]}ngOnInit(){this.subscriptions.push(this.activeRoute.params.subscribe({next:e=>{this.ordersService.findOrderById(e.id).subscribe(e=>{this.order=e})}}),this.activeRoute.url.subscribe({next:e=>{this.hideBuyer="buyer"===e[0].path,this.hideSeller="seller"===e[0].path}}))}ngOnDestroy(){this.subscriptions.forEach(e=>{e.unsubscribe()})}openUserProfile(e){console.log(e)}}return e.\u0275fac=function(t){return new(t||e)(p.Rb(s.a),p.Rb(j.a))},e.\u0275cmp=p.Lb({type:e,selectors:[["app-order-details"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"center"],[3,"userProfile",4,"ngIf"],[1,"list-group","list-group-flush"],[1,"list-group-item"],["color","red"],["mdbBtn","","type","button",1,"primary"],[3,"userProfile"]],template:function(e,t){1&e&&p.Ic(0,L,27,17,"mdb-card",0),2&e&&p.nc("ngIf",t.order)},directives:[c.t,f.F,f.H,f.E,f.J,f.y,W.a,f.D,w.a],pipes:[y.d,c.b,v.a],styles:[""]}),e})();const K=[{path:"seller",component:O},{path:"buyer",component:O},{path:"seller/orderDetail/:id",component:I},{path:"buyer/orderDetail/:id",component:I},{path:"seller/:id",component:O,canActivate:[X.a]},{path:"buyer/:id",component:O,canActivate:[X.a]},{path:"orderDetail/:id",component:I,canActivate:[X.a]}];let C=(()=>{class e{}return e.\u0275mod=p.Pb({type:e}),e.\u0275inj=p.Ob({factory:function(t){return new(t||e)},imports:[[s.g.forChild(K)],s.g]}),e})();var k=r("snw9"),$=r("LRne"),D=r("itXk"),N=r("eIep"),P=r("lJxs"),B=r("JIr8"),E=r("N/25"),F=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let T=(()=>{class e{constructor(e,t,r){this.actions$=e,this.ordersService=t,this.authService=r,this.ordersSearch$=this.actions$.pipe(Object(k.d)(l.d.LoadOrders),Object(N.a)(e=>e.payload.userId?Object($.a)(e.payload):this.authService.getAuthState().pipe(Object(P.a)(t=>{var r;return Object.assign(Object.assign({},e.payload),{userId:null===(r=t)||void 0===r?void 0:r.uid})}))),Object(N.a)(e=>{if(e.userId)return this.ordersService.findOrdersByBuyerId(e.userId,e.type).pipe(Object(N.a)(t=>{if(!t||!t.length)return Object($.a)([]);const r=t.map(t=>{const r=e.type===u.b.SELLER;return this.authService.getDBUserProfile(r?t.buyerUid:t.sellerUid).pipe(Object(P.a)(e=>(r?t.buyer=e:t.seller=e,t)))});return Object(D.a)(r)}),Object(P.a)(e=>new l.c({data:e})));throw new Error("We are doomed.")}),Object(B.a)(e=>Object($.a)(new l.b({error:e}))))}}return e.\u0275fac=function(t){return new(t||e)(p.bc(k.a),p.bc(j.a),p.bc(E.a))},e.\u0275prov=p.Nb({token:e,factory:e.\u0275fac}),function(e,t,r,c){var i,s=arguments.length,o=s<3?t:null===c?c=Object.getOwnPropertyDescriptor(t,r):c;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,c);else for(var n=e.length-1;n>=0;n--)(i=e[n])&&(o=(s<3?i(o):s>3?i(t,r,o):i(t,r))||o);s>3&&o&&Object.defineProperty(t,r,o)}([Object(k.b)(),F("design:type",Object)],e.prototype,"ordersSearch$",void 0),e})(),x=(()=>{class e{}return e.\u0275mod=p.Pb({type:e}),e.\u0275inj=p.Ob({factory:function(t){return new(t||e)},imports:[[C,c.c,i.a,f.W,k.c.forFeature([T])]]}),e})()}}]);