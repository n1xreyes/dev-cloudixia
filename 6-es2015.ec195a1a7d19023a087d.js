(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{abk7:function(e,t,c){"use strict";c.r(t),c.d(t,"ProjectsModule",(function(){return le}));var i=c("kt0X"),r=c("tk/3"),n=c("snw9"),o=c("dbUT"),s=c("EwOj");const a={projects:null,loading:!1,pendingListings:null,pendingLoading:!1,error:null};function p(e=a,t){var c;switch(t.type){case s.f.PROJECTS_QUERY_ALL:case s.f.PROJECTS_QUERY:return Object.assign({},e,{loading:!0});case s.f.PROJECTS_LOADED:return Object.assign({},e,{projects:t.payload.projects,loading:!1});case s.f.MY_PENDING_LISTINGS_QUERY:return Object.assign({},e,{pendingLoading:!0});case s.f.MY_PENDING_LISTINGS_LOADED:return Object.assign({},e,{pendingListings:t.payload.projects,pendingLoading:!1});case s.f.PROJECT_CHANGED:{let r=Object.assign({},e),n=t.payload.project;r.projects=Object.assign([],r.projects);var i=null===(c=r.projects)||void 0===c?void 0:c.findIndex(e=>e.uid===n.uid);switch(t.payload.action){case d.CREATE:return r.projects.push(n),r;case d.UPDATE:return r.projects[i]=n,r;case d.DELETE:return r.projects=r.projects.slice(0,i).concat(r.projects.slice(i+1,r.projects.length)),r}return r}case s.f.PROJECTS_ERROR:return Object.assign({},e,{loading:!1,error:t.payload.error});default:return e}}var d=function(e){return e.CREATE="CREATE",e.UPDATE="UPDATE",e.DELETE="DELETE",e}({}),l=c("zp1y"),b=c("eIep"),u=c("lJxs"),f=c("Xd88"),j=c("Pd99"),g=c("9OjW"),h=c("itXk"),m=c("LRne"),O=c("fXoL"),y=c("eR6d");let v=(()=>{class e{constructor(e){this.marketplaceService=e}add(e,t){return this.marketplaceService.add(e,t)}delete(e){return e.state===j.a.PENDING?this.marketplaceService.deletePending(e):this.marketplaceService.delete(e)}updateListing(e,t){return e.state===j.a.PENDING?this.marketplaceService.updatePending(e,t):this.marketplaceService.update(e,t)}}return e.\u0275fac=function(t){return new(t||e)(O.bc(y.a))},e.\u0275prov=O.Nb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var E=c("N/25"),w=c("OzEI"),I=c("vnnU"),P=function(e,t,c,i){var r,n=arguments.length,o=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,c):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,c,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n<3?r(o):n>3?r(t,c,o):r(t,c))||o);return n>3&&o&&Object.defineProperty(t,c,o),o},C=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let D=(()=>{class e{constructor(e,t,c,r,o,a,p){this.actions$=e,this.projectsService=t,this.store=c,this.authService=r,this.marketplaceService=o,this.categoryService=a,this.buildFileMetadataService=p,this.query$=this.actions$.pipe(Object(n.d)(s.f.PROJECTS_QUERY),Object(l.a)(this.authService.getAuthState()),Object(b.a)(([,e])=>this.marketplaceService.getUsersListings(e.uid)),Object(b.a)(e=>{const t=e.map(e=>this.categoryService.get(e.categories[0]).pipe(Object(u.a)(t=>({category:t.payload.data(),listing:e}))));return Object(h.a)(t)}),Object(u.a)(e=>{const t=e.map(({listing:e,category:t})=>Object.assign(Object.assign({},e),{category:t}));return new s.g({projects:t})})),this.pendingQuery$=this.actions$.pipe(Object(n.d)(s.f.MY_PENDING_LISTINGS_QUERY),Object(l.a)(this.authService.getAuthState()),Object(b.a)(([,e])=>this.marketplaceService.getUsersPendingListings(e.uid)),Object(b.a)(e=>{if(!e||!e.length)return Object(m.a)([]);const t=e.map(e=>this.categoryService.get(e.categories[0]).pipe(Object(u.a)(t=>({category:t.payload.data(),listing:e}))));return Object(h.a)(t)}),Object(u.a)(e=>{console.log("with cat: ",e);const t=e.map(({listing:e,category:t})=>Object.assign(Object.assign({},e),{category:t}));return new s.b({projects:t})})),this.added$=this.actions$.pipe(Object(n.d)(s.f.PROJECT_ADDED),Object(u.a)(e=>e.payload),Object(l.a)(this.store.pipe(Object(i.q)(f.f))),Object(b.a)(([e,t])=>{const c=Object.assign({},e.project),i=e.file;return c.userId=t.uid,c.state=j.a.PENDING,i?(c.file&&delete c.file,this.projectsService.add(c,i)):(c.photoUrl=g.b,this.projectsService.add(c))})),this.delete$=this.actions$.pipe(Object(n.d)(s.f.PROJECT_DELETED),Object(u.a)(e=>e.payload),Object(l.a)(this.store.pipe(Object(i.q)(f.f))),Object(u.a)(([e])=>this.projectsService.delete(e.project))),this.edit$=this.actions$.pipe(Object(n.d)(s.f.PROJECT_EDITED),Object(u.a)(e=>e.payload),Object(l.a)(this.store.pipe(Object(i.q)(f.f))),Object(b.a)(([e])=>{const t=Object.assign({},e.project);return delete t.file,e.file?(t.photoUrl="https://cloudixia-images.s3.us-east-2.amazonaws.com/"+this.buildFileMetadataService.getListingPhotoFileName(t.uid),this.projectsService.updateListing(t,e.file)):this.projectsService.updateListing(t)}))}}return e.\u0275fac=function(t){return new(t||e)(O.bc(n.a),O.bc(v),O.bc(i.h),O.bc(E.a),O.bc(y.a),O.bc(w.a),O.bc(I.a))},e.\u0275prov=O.Nb({token:e,factory:e.\u0275fac}),P([Object(n.b)(),C("design:type",Object)],e.prototype,"query$",void 0),P([Object(n.b)(),C("design:type",Object)],e.prototype,"pendingQuery$",void 0),P([Object(n.b)({dispatch:!1}),C("design:type",Object)],e.prototype,"added$",void 0),P([Object(n.b)({dispatch:!1}),C("design:type",Object)],e.prototype,"delete$",void 0),P([Object(n.b)({dispatch:!1}),C("design:type",Object)],e.prototype,"edit$",void 0),e})();var S=c("tyNb");const L=Object(i.o)("projects"),X=Object(i.p)(L,e=>e.projects),W=Object(i.p)(L,e=>e.loading),R=Object(i.p)(L,e=>e.pendingListings),N=Object(i.p)(L,e=>e.pendingLoading);Object(i.p)(L,e=>e.error);var $=c("IzEk"),k=c("d2bA"),T=c("LbO5"),U=c("XNiG"),_=c("3Pt+"),x=c("NwA8"),A=c("2MfP"),M=c("ofXK"),B=c("znhb"),G=c("ny+X"),K=c("bmSC"),F=c("voVQ");function q(e,t){if(1&e&&(O.Sb(0,"app-category-selection",9),O.ic(1,"async")),2&e){const e=O.hc();O.nc("items",O.jc(1,2,e.categories$))("returnUid",!0)}}let J=(()=>{class e{constructor(e,t,c){this.store=e,this.modalRef=t,this.currencyPipe=c,this.result=new U.a,this.form=new _.i({title:new _.f("",_.E.required),description:new _.f("",_.E.required),categories:new _.f([],_.E.required),photoUrl:new _.f(""),price:new _.f(null,[_.E.required,_.E.min(.01)])})}ngOnInit(){this.categories$=this.store.pipe(Object(i.q)(x.a),Object(u.a)(e=>(e||this.store.dispatch(new A.i),e))),this.store.pipe(Object(i.q)(f.f)).subscribe(e=>{e&&(this.user=e)})}setSelectedPhoto(e){this.entity.file=e}formatCurrency(){var e;null===(e=this.form.get("price"))||void 0===e||e.setValue(this.currencyPipe.transform(this.getPriceNumericValue(),"$","symbol","1.2-2"))}transformPriceValue(){var e;null===(e=this.form.get("price"))||void 0===e||e.setValue(this.getPriceNumericValue())}getPriceNumericValue(){var e,t;return null===(t=(""+(null===(e=this.form.get("price"))||void 0===e?void 0:e.value)).replace(/^\D+|,/g,""))||void 0===t?void 0:t.replace(/^\D+|,/g,"")}checkForLetters(){var e,t;null===(t=(""+(null===(e=this.form.get("price"))||void 0===e?void 0:e.value)).replace(/^\D+|,/g,""))||void 0===t||t.replace(/\p{L}/u,"")}}return e.\u0275fac=function(t){return new(t||e)(O.Rb(i.h),O.Rb(o.z),O.Rb(M.d))},e.\u0275cmp=O.Lb({type:e,selectors:[["app-project-modal"]],decls:10,vars:9,consts:[["entityTitle","project.title",3,"form","entity","saved"],[3,"formGroup"],["name","title","label","project.fields.title"],["type","textarea","name","description","label","project.fields.description"],["formControlName","categories",3,"items","returnUid",4,"ngIf"],[1,"md-form"],["type","hidden","id","photo","name","photoUrl","mdbInput","",1,"form-control",3,"formControl"],[3,"displayUploadButton","userInfo","photoSelected"],["name","price","label","project.fields.price","placeholder","USD $0.00",3,"change","input"],["formControlName","categories",3,"items","returnUid"]],template:function(e,t){1&e&&(O.Xb(0,"app-crud-modal",0),O.fc("saved",(function(e){return t.transformPriceValue(),t.result.next(e)})),O.Xb(1,"form",1),O.Sb(2,"app-input-wrapper",2),O.Sb(3,"app-input-wrapper",3),O.Ic(4,q,2,4,"app-category-selection",4),O.ic(5,"async"),O.Xb(6,"div",5),O.Sb(7,"input",6),O.Xb(8,"app-image-upload",7),O.fc("photoSelected",(function(e){return t.setSelectedPhoto(e)})),O.Wb(),O.Wb(),O.Xb(9,"app-input-wrapper",8),O.fc("change",(function(){return t.formatCurrency()}))("input",(function(){return t.checkForLetters()})),O.Wb(),O.Wb(),O.Wb()),2&e&&(O.nc("form",t.form)("entity",t.entity),O.Cb(1),O.nc("formGroup",t.form),O.Cb(3),O.nc("ngIf",O.jc(5,7,t.categories$)),O.Cb(3),O.nc("formControl",t.form.controls.photoUrl),O.Cb(1),O.nc("displayUploadButton",!1)("userInfo",t.user))},directives:[B.a,_.G,_.r,_.j,G.a,M.t,_.c,o.N,_.q,_.g,K.a,F.a,_.h],pipes:[M.b],styles:[""]}),e})();var Y=c("aECQ"),Q=c("Vtvw");function V(e,t){if(1&e&&O.Sb(0,"mdb-card-img",9),2&e){const e=O.hc(2);O.oc("src",e.project.photoUrl)}}function z(e,t){1&e&&(O.Xb(0,"mdb-badge",10),O.Kc(1,"Active"),O.Wb())}function H(e,t){1&e&&(O.Xb(0,"mdb-badge",11),O.Kc(1,"Pending"),O.Wb())}function Z(e,t){if(1&e){const e=O.Yb();O.Xb(0,"a",12),O.fc("click",(function(){return O.Bc(e),O.hc(2).onEdit()})),O.Kc(1,"Edit"),O.Wb()}}function ee(e,t){if(1&e){const e=O.Yb();O.Xb(0,"mdb-card"),O.Ic(1,V,1,1,"mdb-card-img",1),O.Xb(2,"mdb-card-body",2),O.Xb(3,"mdb-card-title"),O.Xb(4,"h4"),O.Kc(5),O.Wb(),O.Wb(),O.Xb(6,"span",3),O.Ic(7,z,2,0,"mdb-badge",4),O.Ic(8,H,2,0,"mdb-badge",5),O.Wb(),O.Sb(9,"br"),O.Xb(10,"mdb-card-text"),O.Xb(11,"ul"),O.Xb(12,"li"),O.Kc(13),O.Wb(),O.Xb(14,"li"),O.Kc(15),O.ic(16,"projectCategoryTitle"),O.Wb(),O.Xb(17,"li"),O.Kc(18),O.Wb(),O.Wb(),O.Wb(),O.Xb(19,"div",6),O.Ic(20,Z,2,0,"a",7),O.Xb(21,"a",8),O.fc("click",(function(){return O.Bc(e),O.hc().onDelete()})),O.Kc(22,"Delete"),O.Wb(),O.Wb(),O.Wb(),O.Wb()}if(2&e){const e=O.hc();O.Cb(1),O.nc("ngIf",e.project.photoUrl),O.Cb(4),O.Lc(e.project.title),O.Cb(2),O.nc("ngIf","PENDING"!==e.project.state),O.Cb(1),O.nc("ngIf","PENDING"===e.project.state),O.Cb(5),O.Lc(e.project.description),O.Cb(2),O.Lc(O.jc(16,8,e.project)),O.Cb(3),O.Lc(e.project.price),O.Cb(2),O.nc("ngIf",e.editable)}}let te=(()=>{class e{constructor(){this.editable=!0,this.deleted=new O.n,this.edited=new O.n,this.destroyed=new U.a}ngOnInit(){}ngOnChanges(e){e.project&&this.ngOnInit()}onDelete(){this.deleted.emit(this.project)}onEdit(){this.edited.emit(this.project)}ngOnDestroy(){this.destroyed.next(!0)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=O.Lb({type:e,selectors:[["app-project"]],inputs:{project:"project",editable:"editable"},outputs:{deleted:"deleted",edited:"edited"},features:[O.Ab],decls:1,vars:1,consts:[[4,"ngIf"],["alt","Card image cap","class","waves-light","mdbWavesEffect","",3,"src",4,"ngIf"],[2,"height","auto"],[1,"mr-2","float-left","hey-you"],["color","green",4,"ngIf"],["color","purple",4,"ngIf"],[1,"text-left"],["mdbBtn","","color","primary","mdbWavesEffect","",3,"click",4,"ngIf"],["mdbBtn","","mdbWavesEffect","",1,"red","lighten-1","white-text",3,"click"],["alt","Card image cap","mdbWavesEffect","",1,"waves-light",3,"src"],["color","green"],["color","purple"],["mdbBtn","","color","primary","mdbWavesEffect","",3,"click"]],template:function(e,t){1&e&&O.Ic(0,ee,23,10,"mdb-card",0),2&e&&O.nc("ngIf",t.project)},directives:[M.t,o.F,o.E,o.K,o.J,o.D,o.X,o.I,o.y],pipes:[Q.a],styles:[""],changeDetection:0}),e})();function ce(e,t){if(1&e){const e=O.Yb();O.Xb(0,"div",2),O.Xb(1,"app-project",3),O.fc("deleted",(function(t){return O.Bc(e),O.hc().onProjectDelete(t)}))("edited",(function(t){return O.Bc(e),O.hc().onProjectEdit(t)})),O.Wb(),O.Wb()}if(2&e){const e=t.$implicit,c=O.hc();O.Cb(1),O.nc("project",e)("editable",c.editable)}}let ie=(()=>{class e{constructor(){this.editable=!0,this.projectDeleted=new O.n,this.projectEdited=new O.n}ngOnInit(){}onProjectDelete(e){this.projectDeleted.emit(e)}onProjectEdit(e){this.projectEdited.emit(e)}trackByFunction(e){return e}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=O.Lb({type:e,selectors:[["app-projects-list"]],inputs:{projects:"projects",editable:"editable"},outputs:{projectDeleted:"projectDeleted",projectEdited:"projectEdited"},decls:2,vars:2,consts:[[1,"projects-list","d-flex","flex-wrap","fadeIn","animated"],["class","project",4,"ngFor","ngForOf","ngForTrackBy"],[1,"project"],[3,"project","editable","deleted","edited"]],template:function(e,t){1&e&&(O.Xb(0,"div",0),O.Ic(1,ce,2,2,"div",1),O.Wb()),2&e&&(O.Cb(1),O.nc("ngForOf",t.projects)("ngForTrackBy",t.trackByFunction))},directives:[M.s,te],styles:[".projects-list[_ngcontent-%COMP%]{box-sizing:border-box;justify-content:center}.project[_ngcontent-%COMP%]{width:80%;margin:1rem}@media (min-width:768px){.project[_ngcontent-%COMP%]{width:calc(50% - 2rem)}.projects-list[_ngcontent-%COMP%]{justify-content:normal}}@media (min-width:992px){.project[_ngcontent-%COMP%]{width:calc(33.3333% - 2rem)}}@media (min-width:1200px){.project[_ngcontent-%COMP%]{width:calc(25% - 3rem)}}"],changeDetection:0}),e})();function re(e,t){if(1&e){const e=O.Yb();O.Xb(0,"app-projects-list",7),O.fc("projectDeleted",(function(t){return O.Bc(e),O.hc().onProjectDelete(t)}))("projectEdited",(function(t){return O.Bc(e),O.hc().openModal(t)})),O.ic(1,"async"),O.Wb()}if(2&e){const e=O.hc();O.nc("projects",O.jc(1,1,e.projects$))}}function ne(e,t){1&e&&(O.Xb(0,"div",8),O.Xb(1,"div",9),O.Xb(2,"span",10),O.Kc(3,"Loading..."),O.Wb(),O.Wb(),O.Wb())}function oe(e,t){if(1&e){const e=O.Yb();O.Xb(0,"app-projects-list",7),O.fc("projectDeleted",(function(t){return O.Bc(e),O.hc().onProjectDelete(t)}))("projectEdited",(function(t){return O.Bc(e),O.hc().openModal(t)})),O.ic(1,"async"),O.Wb()}if(2&e){const e=O.hc();O.nc("projects",O.jc(1,1,e.pendingListings$))}}function se(e,t){1&e&&(O.Xb(0,"div",8),O.Xb(1,"div",9),O.Xb(2,"span",10),O.Kc(3,"Loading..."),O.Wb(),O.Wb(),O.Wb())}const ae=[{path:"",component:(()=>{class e{constructor(e,t,c){this.store=e,this.modalService=t,this.afAuth=c,this.modalConfig={class:"modal-dialog-scrollable"}}get user(){return this.afAuth.auth.currentUser}ngOnInit(){this.isLoading$=this.store.select(W),this.projects$=this.store.pipe(Object(i.q)(X),Object(u.a)(e=>(this.user&&!e&&this.store.dispatch(new s.h),e))),this.isPendingLoading$=this.store.select(N),this.pendingListings$=this.store.pipe(Object(i.q)(R),Object(u.a)(e=>(this.user&&!e&&this.store.dispatch(new s.a),e)))}openModal(e=new T.b){const t=!!e.uid;this.modalService.show(J,Object.assign(Object.assign({},this.modalConfig),{data:{entity:Object.assign({},e)}})).content.result.pipe(Object($.a)(1)).subscribe(e=>{delete e.category;const c=t?new s.e({project:e,file:e.file}):new s.c({project:e,file:e.file});this.store.dispatch(c)})}openConfirmModal(e){var t;null===(t=this.modalService.show(k.a,Object.assign(Object.assign({},g.a),{data:Object.assign({},g.c)})))||void 0===t||t.content.confirmation.pipe(Object($.a)(1)).subscribe(t=>{t&&this.store.dispatch(new s.d({project:e}))})}onProjectDelete(e){this.openConfirmModal(e)}}return e.\u0275fac=function(t){return new(t||e)(O.Rb(i.h),O.Rb(o.A),O.Rb(Y.a))},e.\u0275cmp=O.Lb({type:e,selectors:[["app-projects"]],decls:19,vars:12,consts:[[1,"white","px-4","section-header"],[1,"grey-text","pt-3"],[1,"container-fluid","pb-5"],[1,"py-5"],["mdbBtn","","color","primary",1,"ml-3",3,"click"],["class","project-listing-cards",3,"projects","projectDeleted","projectEdited",4,"ngIf"],["class","d-flex justify-content-center align-items-center","style","margin-top: 200px",4,"ngIf"],[1,"project-listing-cards",3,"projects","projectDeleted","projectEdited"],[1,"d-flex","justify-content-center","align-items-center",2,"margin-top","200px"],["role","status",1,"spinner-grow","text-primary",2,"width","4rem","height","4rem"],[1,"sr-only"]],template:function(e,t){1&e&&(O.Xb(0,"div",0),O.Xb(1,"h3"),O.Kc(2,"Manage Listings"),O.Wb(),O.Xb(3,"p",1),O.Kc(4,"Manage your services"),O.Wb(),O.Wb(),O.Xb(5,"div",2),O.Xb(6,"div",3),O.Xb(7,"button",4),O.fc("click",(function(){return t.openModal()})),O.Kc(8,"Add new service"),O.Wb(),O.Ic(9,re,2,3,"app-projects-list",5),O.ic(10,"async"),O.Ic(11,ne,4,0,"div",6),O.ic(12,"async"),O.Xb(13,"h2"),O.Kc(14,"Pending Listings"),O.Wb(),O.Ic(15,oe,2,3,"app-projects-list",5),O.ic(16,"async"),O.Ic(17,se,4,0,"div",6),O.ic(18,"async"),O.Wb(),O.Wb()),2&e&&(O.Cb(9),O.nc("ngIf",O.jc(10,4,t.projects$)),O.Cb(2),O.nc("ngIf",O.jc(12,6,t.isLoading$)),O.Cb(4),O.nc("ngIf",O.jc(16,8,t.pendingListings$)),O.Cb(2),O.nc("ngIf",O.jc(18,10,t.isPendingLoading$)))},directives:[o.D,M.t,ie],pipes:[M.b],styles:[""]}),e})()}];let pe=(()=>{class e{}return e.\u0275mod=O.Pb({type:e}),e.\u0275inj=O.Ob({factory:function(t){return new(t||e)},imports:[[S.g.forChild(ae)],S.g]}),e})();var de=c("PCNd");let le=(()=>{class e{}return e.\u0275mod=O.Pb({type:e}),e.\u0275inj=O.Ob({factory:function(t){return new(t||e)},imports:[[o.T,pe,r.b,i.j.forFeature("projects",p),n.c.forFeature([D]),de.a]]}),e})()}}]);